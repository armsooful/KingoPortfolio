---
date: 2026-01-20 22:38:52
created: 2026-01-20 22:38:43
categories:
- Foresto Compass
---

# Phase 7 상세 스펙 (Specification)

## 0\. 스펙의 전제

- 본 스펙은 **Phase 6 규칙을 상위 제약조건**으로 한다.
- Phase 7에서는 **기능 구현만 수행**하며,  
표현·판단·비교 규칙은 **변경 불가(Frozen)** 상태이다.
- 모든 결과는 **과거 데이터 기반 분석 결과**로 한정된다.

* * *

## 1\. Phase 7 목표 (스펙 기준)

> 사용자가 직접 구성한 포트폴리오를 대상으로  
> 과거 데이터 기반 성과·리스크를 계산·표출·비교하는  
> 사용자 기능을 최초로 제공한다.

* * *

## 2\. 기능 범위 (Scope)

### 2.1 In-Scope

- 종목/섹터 직접 선택
- 비중 입력(합 100%)
- 과거 데이터 기반 평가
- 자기 포트폴리오 간 비교
- 저장 및 히스토리 조회

### 2.2 Out-of-Scope

- 종목/비중 추천
- 자동 최적화
- 시장/지수 대비 우열 비교
- 미래 성과 예측
- 자동 판정/점수/랭킹

* * *

## 3\. 사용자 입력 스펙

### 3.1 포트폴리오 구성 입력

```
{
  "portfolio_type": "SECURITY | SECTOR",
  "items": [
    {
      "id": "string",
      "name": "string",
      "weight": 0.25
    }
  ]
}
```

#### 제약

- `items[].weight` 합계 = 1.0
- 종목/섹터 혼용 불가
- 기본 선택값 없음

* * *

### 3.2 평가 설정 입력

```
{
  "period": {
    "start": "YYYY-MM-DD",
    "end": "YYYY-MM-DD"
  },
  "rebalance": "NONE | MONTHLY | QUARTERLY"
}
```

#### 제약

- 미래 날짜 입력 불가
- start < end 필수

* * *

## 4\. 평가 엔진 스펙

### 4.1 입력 → 출력 흐름

```
입력 구성
 → 가격 시계열 로딩
 → 포트폴리오 NAV 생성
 → 지표 계산
 → Output Schema v2 반환
```

* * *

### 4.2 가격 데이터

- 단위: 일간
- 값: 종가 또는 조정종가
- 기준일/출처 메타데이터 유지

* * *

### 4.3 포트폴리오 시계열(NAV)

- 가중평균 방식
- 리밸런싱 가정 반영
- 거래비용/세금: Phase 7에서는 0 고정

* * *

### 4.4 지표 계산 정의

| 지표  | 정의  |
| --- | --- |
| 누적수익률 | `(종료 NAV / 시작 NAV) - 1` |
| CAGR | 연환산 수익률 |
| 변동성 | 일간 수익률 표준편차 연환산 |
| MDD | 기간 내 최대 낙폭 |

* * *

## 5\. 출력 스펙 (Output Schema v2)

```
{
  "period": {
    "start": "YYYY-MM-DD",
    "end": "YYYY-MM-DD"
  },
  "metrics": {
    "cumulative_return": 0.42,
    "cagr": 0.074,
    "volatility": 0.142,
    "max_drawdown": -0.286
  },
  "disclaimer_version": "v2"
}
```

#### 제약

- 점수/상태/우열 필드 없음
- 수치 + 기간 정보만 포함

* * *

## 6\. 결과 표출(UI) 스펙

### 6.1 결과 요약 화면

- 필수 표시
    - 분석 기간
    - 지표 표

- 금지
    - 형용사/판정 문구
    - 강조 색상

* * *

### 6.2 차트 화면

- 허용
    - NAV 추이
    - 누적수익률
    - MDD 드로다운

- 금지
    - 목표선
    - 추천 구간
    - 색상 우열 암시

* * *

## 7\. 비교 기능 스펙

### 7.1 비교 입력

```
{
  "portfolio_ids": ["id1", "id2"]
}
```

#### 제약

- 동일 사용자 소유 포트폴리오만 가능
- 최소 2개, 최대 N개(정책값)

* * *

### 7.2 비교 출력

- 지표 병렬 나열
- 동일 축 차트 병렬
- 자동 판정/승자 표시 없음

* * *

## 8\. 저장 및 히스토리 스펙

### 8.1 포트폴리오 저장

```
{
  "portfolio_id": "string",
  "config": { ... },
  "created_at": "timestamp"
}
```

* * *

### 8.2 평가 히스토리

- 평가 시점 기준 결과 저장
- 재조회 시 동일 결과 보장

* * *

## 9\. 오류 처리 스펙

### 허용 오류 메시지

- “데이터가 일부 누락되어 계산이 제한됩니다.”
- “선택한 기간의 과거 데이터를 불러올 수 없습니다.”

### 금지 오류 메시지

- “다른 구성을 추천합니다”
- “위험한 포트폴리오입니다”

* * *

## 10\. Phase 6 준수 스펙

- 금지어 자동 스캔 필수
- Golden Test CI 통합
- Phase 6 검수 리포트 승인 상태 유지

* * *

## 11\. Phase 7 완료 기준 (Spec 기준)

- 모든 API가 본 스펙 충족
- Phase 6 규칙 위반 0건
- 사용자 기능 End-to-End 동작
- 외부 공개 가능 상태

* * *

## 12\. 내부 한 줄 요약

> **Phase 7 스펙은 “무엇을 계산할 것인가”보다  
> “무엇을 절대 말하지 않을 것인가”를 먼저 정의한 스펙이다.**

* * *

### 다음 단계 선택

이 스펙 다음으로 바로 이어질 수 있는 것은:

1. **Phase 7 API 상세 계약서(OpenAPI)**
2. **Phase 7 테스트 케이스 명세**
3. **Phase 7 개발자 온보딩 가이드**

원하시는 번호를 말씀해 주세요.