# ë³µí•© ë“±ê¸‰ ì²´ê³„ ê°€ì´ë“œ

KingoPortfolioëŠ” **VIP ë“±ê¸‰**ê³¼ **ë©¤ë²„ì‹­ í”Œëœ**ì„ ê²°í•©í•œ ë³µí•© ë“±ê¸‰ ì²´ê³„ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ì°¨ë“±í™”ëœ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“Š ë“±ê¸‰ ì²´ê³„ ê°œìš”

### 1. VIP ë“±ê¸‰ (í™œë™ ê¸°ë°˜, ìë™ ë¶€ì—¬)

ì‚¬ìš©ìì˜ í™œë™ ì ìˆ˜ ë˜ëŠ” ì´ ìì‚°ì— ë”°ë¼ ìë™ìœ¼ë¡œ ê²°ì •ë˜ëŠ” ë“±ê¸‰ì…ë‹ˆë‹¤.

| ë“±ê¸‰ | í•„ìš” ì¡°ê±´ | í¬íŠ¸í´ë¦¬ì˜¤ | ê³¼ê±° ë°ì´í„° | í™œë™ ì ìˆ˜ ë°°ìœ¨ |
|------|----------|-----------|------------|---------------|
| ğŸ¥‰ **Bronze** | ê¸°ë³¸ ë“±ê¸‰ | ìµœëŒ€ 3ê°œ | 3ê°œì›” | 1.0x |
| ğŸ¥ˆ **Silver** | í™œë™ ì ìˆ˜ 100ì  ì´ìƒ<br/>ë˜ëŠ” ìì‚° 5ì²œë§Œì› ì´ìƒ | ìµœëŒ€ 5ê°œ | 6ê°œì›” | 1.2x |
| ğŸ¥‡ **Gold** | í™œë™ ì ìˆ˜ 500ì  ì´ìƒ<br/>ë˜ëŠ” ìì‚° 1ì–µì› ì´ìƒ | ìµœëŒ€ 10ê°œ | 1ë…„ | 1.5x |
| ğŸ’ **Platinum** | í™œë™ ì ìˆ˜ 1,000ì  ì´ìƒ<br/>ë˜ëŠ” ìì‚° 5ì–µì› ì´ìƒ | ìµœëŒ€ 20ê°œ | 2ë…„ | 2.0x |
| ğŸ’  **Diamond** | í™œë™ ì ìˆ˜ 3,000ì  ì´ìƒ<br/>ë˜ëŠ” ìì‚° 10ì–µì› ì´ìƒ | ìµœëŒ€ 100ê°œ | 5ë…„ | 3.0x |

### 2. ë©¤ë²„ì‹­ í”Œëœ (ìœ ë£Œ êµ¬ë…)

ì‚¬ìš©ìê°€ ì„ íƒí•˜ëŠ” ìœ ë£Œ êµ¬ë… í”Œëœì…ë‹ˆë‹¤.

| í”Œëœ | ê°€ê²© | AI ìš”ì²­ | ë¦¬í¬íŠ¸ | ê³ ê¸‰ ì°¨íŠ¸ | PDF ë‚´ë³´ë‚´ê¸° | ì‹¤ì‹œê°„ ë°ì´í„° | ë§ì¶¤ ì•Œë¦¼ |
|------|------|---------|--------|----------|--------------|--------------|----------|
| ğŸ†“ **Free** | ë¬´ë£Œ | ì›” 10íšŒ | ì›” 2ê°œ | âŒ | âŒ | âŒ | âŒ |
| ğŸŒ± **Starter** | ì›” 9,900ì› | ì›” 50íšŒ | ì›” 10ê°œ | âœ… | âœ… | âŒ | âŒ |
| ğŸš€ **Pro** | ì›” 29,900ì› | ì›” 200íšŒ | ì›” 50ê°œ | âœ… | âœ… | âœ… | âœ… |
| ğŸ¢ **Enterprise** | ì›” 99,900ì› | ì›” 1000íšŒ | ì›” 500ê°œ | âœ… | âœ… | âœ… | âœ… + ì»¨ì„¤íŒ… |

## ğŸ¯ í™œë™ ì ìˆ˜ íšë“ ë°©ë²•

í™œë™ ì ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í™œë™ì„ í†µí•´ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

| í™œë™ | ê¸°ë³¸ ì ìˆ˜ | VIP ë°°ìœ¨ ì ìš© | ì„¤ëª… |
|------|----------|--------------|------|
| í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„± | 50ì  | âœ… | ìƒˆë¡œìš´ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ìƒì„±í•˜ë©´ íšë“ |
| ì§„ë‹¨ ì™„ë£Œ | 30ì  | âœ… | íˆ¬ì ì„±í–¥ ì§„ë‹¨ì„ ì™„ë£Œí•˜ë©´ íšë“ |
| ë¦¬í¬íŠ¸ ìƒì„± | 20ì  | âœ… | íˆ¬ì ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ë©´ íšë“ |
| ë§¤ì¼ ë¡œê·¸ì¸ | 5ì  | âœ… | í•˜ë£¨ 1íšŒ ë¡œê·¸ì¸ ì‹œ íšë“ |
| í”„ë¡œí•„ ì™„ì„± | 100ì  | âŒ | í”„ë¡œí•„ì„ 100% ì‘ì„±í•˜ë©´ 1íšŒ íšë“ |

**VIP ë°°ìœ¨**: ë†’ì€ VIP ë“±ê¸‰ì¼ìˆ˜ë¡ ë™ì¼í•œ í™œë™ìœ¼ë¡œ ë” ë§ì€ ì ìˆ˜ë¥¼ íšë“í•©ë‹ˆë‹¤.
- Bronze: 1.0x
- Silver: 1.2x (ê¸°ë³¸ 50ì  â†’ 60ì )
- Gold: 1.5x (ê¸°ë³¸ 50ì  â†’ 75ì )
- Platinum: 2.0x (ê¸°ë³¸ 50ì  â†’ 100ì )
- Diamond: 3.0x (ê¸°ë³¸ 50ì  â†’ 150ì )

## ğŸ”§ API ì—”ë“œí¬ì¸íŠ¸

### 1. ê¶Œí•œ ì¡°íšŒ
```http
GET /auth/tier/permissions
Authorization: Bearer {token}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "user_id": "usr_abc123xyz",
  "email": "user@example.com",
  "vip_tier": "silver",
  "activity_points": 150,
  "membership_plan": "starter",
  "membership_status": {
    "plan": "starter",
    "is_active": true,
    "start_date": "2026-01-01T00:00:00Z",
    "end_date": "2026-02-01T00:00:00Z",
    "days_remaining": 30
  },
  "permissions": {
    "max_portfolios": 5,
    "historical_data_months": 6,
    "activity_point_multiplier": 1.2,
    "monthly_ai_requests": 50,
    "monthly_reports": 10,
    "advanced_charts": true,
    "export_reports": true,
    "real_time_data": false,
    "custom_alerts": false,
    "current_ai_requests": 3,
    "current_reports": 1
  }
}
```

### 2. ë“±ê¸‰ ìƒíƒœ ì¡°íšŒ
```http
GET /auth/tier/status
Authorization: Bearer {token}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "current_tier": "silver",
  "activity_points": 150,
  "total_assets_ë§Œì›": 3000,
  "next_tier": {
    "tier": "gold",
    "required_activity_points": 500,
    "remaining_activity_points": 350,
    "required_total_assets_ë§Œì›": 10000,
    "remaining_total_assets_ë§Œì›": 7000,
    "progress_percentage": 30
  },
  "membership_plan": "starter",
  "membership_active": true
}
```

### 3. VIP ë“±ê¸‰ ì—…ê·¸ë ˆì´ë“œ í…ŒìŠ¤íŠ¸ (ê°œë°œ/ë°ëª¨ìš©)
```http
POST /auth/tier/test-upgrade?points=150
Authorization: Bearer {token}
```

**ì£¼ì˜**: ì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” í…ŒìŠ¤íŠ¸/ë°ëª¨ìš©ì…ë‹ˆë‹¤. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì œê±°í•˜ê±°ë‚˜ admin ê¶Œí•œìœ¼ë¡œ ì œí•œí•´ì•¼ í•©ë‹ˆë‹¤.

## ğŸ’» ì½”ë“œ ì‚¬ìš© ì˜ˆì‹œ

### Python (Backend)

```python
from app.models.user import User
from app.utils.tier_permissions import (
    get_user_permissions,
    can_create_portfolio,
    can_request_ai_analysis,
    add_activity_points
)

# ì‚¬ìš©ì ê¶Œí•œ ì¡°íšŒ
permissions = get_user_permissions(user)
print(f"ìµœëŒ€ í¬íŠ¸í´ë¦¬ì˜¤: {permissions['combined_permissions']['max_portfolios']}")

# í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„± ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
can_create, message = can_create_portfolio(user, current_count=2)
if not can_create:
    raise HTTPException(status_code=403, detail=message)

# AI ë¶„ì„ ìš”ì²­ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
can_request, message = can_request_ai_analysis(user)
if not can_request:
    raise HTTPException(status_code=403, detail=message)

# í™œë™ ì ìˆ˜ ì¶”ê°€
add_activity_points(user, points=50, activity_type="í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±")
db.commit()
```

### JavaScript (Frontend)

```javascript
// ê¶Œí•œ ì¡°íšŒ
const response = await api.get('/auth/tier/permissions');
const permissions = response.data.permissions;

console.log(`VIP ë“±ê¸‰: ${response.data.vip_tier}`);
console.log(`ìµœëŒ€ í¬íŠ¸í´ë¦¬ì˜¤: ${permissions.max_portfolios}`);
console.log(`ê³ ê¸‰ ì°¨íŠ¸: ${permissions.advanced_charts ? 'ê°€ëŠ¥' : 'ë¶ˆê°€ëŠ¥'}`);

// ë“±ê¸‰ ìƒíƒœ ì¡°íšŒ
const statusResponse = await api.get('/auth/tier/status');
const status = statusResponse.data;

if (status.next_tier) {
  const progress = status.next_tier.progress_percentage;
  console.log(`ë‹¤ìŒ ë“±ê¸‰ê¹Œì§€: ${progress}%`);
  console.log(`í•„ìš” ì ìˆ˜: ${status.next_tier.remaining_activity_points}`);
}
```

## ğŸ› ï¸ ê¶Œí•œ ì²´í¬ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜

### í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„± ì²´í¬
```python
from app.utils.tier_permissions import can_create_portfolio

can_create, message = can_create_portfolio(user, current_portfolio_count=5)
if not can_create:
    # ê¶Œí•œ ì—†ìŒ: "í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„± í•œë„ì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤. (ìµœëŒ€ 5ê°œ, í˜„ì¬ VIP ë“±ê¸‰: SILVER)"
    raise HTTPException(status_code=403, detail=message)
```

### AI ë¶„ì„ ìš”ì²­ ì²´í¬
```python
from app.utils.tier_permissions import can_request_ai_analysis, increment_ai_requests

can_request, message = can_request_ai_analysis(user)
if not can_request:
    raise HTTPException(status_code=403, detail=message)

# AI ë¶„ì„ ì‹¤í–‰
result = perform_ai_analysis(...)

# ì‚¬ìš©ëŸ‰ ì¦ê°€
increment_ai_requests(user)
db.commit()
```

### ë¦¬í¬íŠ¸ ìƒì„± ì²´í¬
```python
from app.utils.tier_permissions import can_generate_report, increment_report_generation

can_generate, message = can_generate_report(user)
if not can_generate:
    raise HTTPException(status_code=403, detail=message)

# ë¦¬í¬íŠ¸ ìƒì„±
report = generate_report(...)

# ì‚¬ìš©ëŸ‰ ì¦ê°€
increment_report_generation(user)
db.commit()
```

### ê³ ê¸‰ ê¸°ëŠ¥ ì ‘ê·¼ ì²´í¬
```python
from app.utils.tier_permissions import (
    can_access_advanced_charts,
    can_export_report,
    can_access_real_time_data
)

# ê³ ê¸‰ ì°¨íŠ¸ ì ‘ê·¼
can_access, message = can_access_advanced_charts(user)
if not can_access:
    # Starter ì´ìƒ í”Œëœ í•„ìš”
    raise HTTPException(status_code=403, detail=message)

# ë¦¬í¬íŠ¸ ë‚´ë³´ë‚´ê¸°
can_export, message = can_export_report(user)
if not can_export:
    # Starter ì´ìƒ í”Œëœ í•„ìš”
    raise HTTPException(status_code=403, detail=message)

# ì‹¤ì‹œê°„ ë°ì´í„° ì ‘ê·¼
can_access_rt, message = can_access_real_time_data(user)
if not can_access_rt:
    # Pro ì´ìƒ í”Œëœ í•„ìš”
    raise HTTPException(status_code=403, detail=message)
```

## ğŸ“ˆ VIP ë“±ê¸‰ ìë™ ì—…ë°ì´íŠ¸

VIP ë“±ê¸‰ì€ í™œë™ ì ìˆ˜ ë˜ëŠ” ì´ ìì‚°ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.

```python
from app.utils.tier_permissions import update_vip_tier

# ë°©ë²• 1: í™œë™ ì ìˆ˜ ì¶”ê°€ ì‹œ ìë™ ì—…ë°ì´íŠ¸
add_activity_points(user, points=50, activity_type="í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±")
# ë‚´ë¶€ì ìœ¼ë¡œ update_vip_tier()ê°€ í˜¸ì¶œë˜ì–´ ìë™ ì—…ê·¸ë ˆì´ë“œ

# ë°©ë²• 2: ìˆ˜ë™ ì—…ë°ì´íŠ¸
new_tier, tier_changed = update_vip_tier(user)
if tier_changed:
    print(f"ğŸŠ VIP ë“±ê¸‰ ìƒìŠ¹! â†’ {new_tier}")
```

## ğŸ”„ ì›”ë³„ ì‚¬ìš©ëŸ‰ ë¦¬ì…‹

AI ìš”ì²­ íšŸìˆ˜ì™€ ë¦¬í¬íŠ¸ ìƒì„± íšŸìˆ˜ëŠ” ë§¤ì›” ìë™ìœ¼ë¡œ ë¦¬ì…‹ë©ë‹ˆë‹¤.

```python
from app.utils.tier_permissions import reset_monthly_usage_if_needed

# ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹œ ìë™ìœ¼ë¡œ ë¦¬ì…‹ ì²´í¬
reset_monthly_usage_if_needed(user)
db.commit()
```

ë§ˆì§€ë§‰ ë¦¬ì…‹ ì‹œì ë¶€í„° 30ì¼ì´ ê²½ê³¼í•˜ë©´ ìë™ìœ¼ë¡œ ì‚¬ìš©ëŸ‰ì´ 0ìœ¼ë¡œ ë¦¬ì…‹ë©ë‹ˆë‹¤.

## âš™ï¸ ì„¤ì • ë° ì»¤ìŠ¤í„°ë§ˆì´ì§•

ë“±ê¸‰ë³„ ê¶Œí•œ ì„¤ì •ì€ `backend/app/utils/tier_permissions.py` íŒŒì¼ì—ì„œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# VIP ë“±ê¸‰ë³„ ê¶Œí•œ
VIP_TIER_PERMISSIONS = {
    'bronze': {
        'max_portfolios': 3,
        'historical_data_months': 3,
        'activity_point_multiplier': 1.0,
    },
    # ...
}

# ë©¤ë²„ì‹­ í”Œëœë³„ ê¶Œí•œ
MEMBERSHIP_PERMISSIONS = {
    'free': {
        'monthly_ai_requests': 10,
        'monthly_reports': 2,
        'advanced_charts': False,
        # ...
    },
    # ...
}

# VIP ë“±ê¸‰ ì—…ê·¸ë ˆì´ë“œ ê¸°ì¤€
VIP_TIER_THRESHOLDS = {
    'silver': {'activity_points': 100, 'total_assets_ë§Œì›': 5000},
    'gold': {'activity_points': 500, 'total_assets_ë§Œì›': 10000},
    # ...
}
```

## ğŸš€ í”„ë¡œë•ì…˜ ë°°í¬ ì‹œ ì£¼ì˜ì‚¬í•­

1. **í…ŒìŠ¤íŠ¸ ì—”ë“œí¬ì¸íŠ¸ ì œê±°**
   - `/auth/tier/test-upgrade` ì—”ë“œí¬ì¸íŠ¸ëŠ” ë°˜ë“œì‹œ ì œê±°í•˜ê±°ë‚˜ admin ê¶Œí•œìœ¼ë¡œ ì œí•œí•˜ì„¸ìš”.

2. **í™œë™ ì ìˆ˜ íšë“ ë¡œì§ êµ¬í˜„**
   - ì‹¤ì œ í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±, ì§„ë‹¨ ì™„ë£Œ ë“±ì˜ ì´ë²¤íŠ¸ì— `add_activity_points()` í˜¸ì¶œ ì¶”ê°€

3. **ë©¤ë²„ì‹­ ê²°ì œ ì‹œìŠ¤í…œ ì—°ë™**
   - ê²°ì œ ì™„ë£Œ ì‹œ `membership_plan`, `membership_start_date`, `membership_end_date` ì—…ë°ì´íŠ¸
   - ìë™ ê°±ì‹  ë˜ëŠ” ë§Œë£Œ ì²˜ë¦¬ ë¡œì§ êµ¬í˜„

4. **ê¶Œí•œ ì²´í¬ ì ìš©**
   - ëª¨ë“  ì£¼ìš” ê¸°ëŠ¥(í¬íŠ¸í´ë¦¬ì˜¤, AI ë¶„ì„, ë¦¬í¬íŠ¸ ë“±)ì— ê¶Œí•œ ì²´í¬ ì¶”ê°€

5. **ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…**
   - ë“±ê¸‰ ê´€ë ¨ í•„ë“œê°€ ì¶”ê°€ë˜ì—ˆìœ¼ë¯€ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ ë°±ì—… í•„ìˆ˜

## ğŸ“ ë¬¸ì˜

ë“±ê¸‰ ì²´ê³„ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë‹¤ìŒ ì±„ë„ì„ ì´ìš©í•´ì£¼ì„¸ìš”:
- GitHub Issues: https://github.com/your-repo/issues
- ì´ë©”ì¼: support@kingoportfolio.com
